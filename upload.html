<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload File</title>
</head>
<body>
<h1>Upload File</h1>
<input type="file" id="fileInput" required>
<button onclick="uploadFile()">Upload</button>

<script>
  import {BlobServiceClient} from "@azure/storage-blob";

  const storageAccountName = "spcabmktz";
  const storageAccountKey = "F1yxe7nId/HSeDOYW5o6L6Z+aB+kxyTxO2Vl6ZP77ffkUhtVWExTlWi8IDEL+Ih++PNSYcrAF/rl+AStpkWFzA==";
  const containerName = "aplikacja";
  const blobServiceClient = BlobServiceClient.fromConnectionString(`DefaultEndpointsProtocol=https;AccountName=${storageAccountName};AccountKey=${storageAccountKey};EndpointSuffix=core.windows.net`);

  async function uploadToBlobStorage(file) {
    const containerClient = blobServiceClient.getContainerClient(containerName);
    const fileName = file.name;
    const blockBlobClient = containerClient.getBlockBlobClient(fileName);

    try {
      // Otwórz plik do przesłania
      const data = await file.arrayBuffer();

      // Prześlij plik do Azure Storage Blob
      const uploadBlobResponse = await blockBlobClient.upload(data, data.byteLength);
      console.log(`File uploaded successfully. Request Id: ${uploadBlobResponse.requestId}`);
    } catch (error) {
      console.error("Error uploading file:", error.message);
    }
  }

  function uploadFile() {
    const fileInput = document.getElementById("fileInput");
    const selectedFile = fileInput.files[0];

    if (selectedFile) {
      uploadToBlobStorage(selectedFile);
    } else {
      console.error("No file selected.");
    }
  }
</script>
</body>
</html>
